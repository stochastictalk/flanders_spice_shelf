---
title: "Flanders Spice Shelf"
author: "Jerome Wynne"
date: "04/07/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,  warning=FALSE, message=FALSE)
```

# Source Data

```{r, include=TRUE}
library(tidyverse)
library(DT)

df <- readr::read_csv("flanders-spice-shelf.csv") %>%
  mutate(Initial = stringr::str_sub(Item, 1, 1))

DT::datatable(df)
```
# Which initial letter is most popular?

```{r, echo=FALSE, fig.width=7, fig.height=4}
library(viridis)

summarise_initial_count <- function(df) {
  df_result <- dplyr::left_join(
    tibble(`Initial` = stringr::str_split("ABCDEFGHIJKLMNOPQRSTUVWXYZ", "")[[1]]),
    df %>% group_by(Initial) %>% count, 
    by="Initial"
    ) %>%
    tidyr::replace_na(list(Initial = NA, n = 0)) %>%
    rename(`Count of items`=`n`)
}

df %>%
  summarise_initial_count() %>%
  mutate(`Proportion of items` = `Count of items`/sum(`Count of items`)) %>%
  ggplot(
    aes(
      x = `Proportion of items`,
      y = Initial,
      fill = `Proportion of items`
      )
    ) +
  geom_col() +
  scale_y_discrete(limits = rev) +
  scale_fill_viridis() +
  theme_minimal()
```
